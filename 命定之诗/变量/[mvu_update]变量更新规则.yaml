---
variables_update_rules:
  世界:
    时间:
      format: 复兴纪元${yyy}年-${mm}月-${dd}日-${hh}:${mm}
      check:
        - 24小时制
        - 每次剧情推进、行动、休息或旅行后更新，保持时间流逝合理
        - 若时间跨度较大，应说明跳跃原因
    地点:
      format: ${大陆方位}-${区域/地理特征}-${国家/势力范围}-${聚落点/地标}-${具体方位/内部区域}-${详细位置}
      check:
        - 随剧情发展或<user>移动实时变更
        - 层级可根据实际情况省略，但至少保留3层

  任务列表:
    type: |-
      {
        [任务名称: string]: {
          简介: string; // 任务的详细描述
          目标: string; // 完成任务需要达成的具体条件
          奖励: string; // 完成任务可获得的奖励
        }
      }
    check:
      - 随剧情推进、<user>实际行为更新
      - 任务完成且领取奖励后直接删除该任务
      - 任务名称必须为中文
      - 避免一次性添加超过3个任务，保持焦点

  主角:
    种族: &race
      check:
        - 仅当角色的种族发生实质性变化时才更新
    身份: &identity
      type: Array<string>
      check:
        - 随剧情推进、角色实际行为更新
        - 可同时拥有多个身份
        - 相似或重复的身份不记录
    职业: &occupation
      type: Array<string>
      check:
        - 随剧情推进、角色实际行为更新
        - 可同时拥有多个职业
        - 相似或重复的职业不记录
    _生命层级:
      type: readonly
      value: <user>当前的生命层级
    _等级:
      type: readonly
      value: <user>当前的等级
    累计经验值:
      type: number
      check:
        - 随剧情推进、战斗等情况增加
    _升级所需经验:
      type: readonly
      value: <user>当前升级所需的经验值
    冒险者等级:
      check:
        - 随<user>在冒险者公会的表现和评级更新
    属性点:
      type: number
      check:
        - 仅<user>明确分配属性时减少
        - 不可随意增加，不随等级自动增长
    属性.${五维}:
      type: number
      五维: 力量 | 敏捷 | 体质 | 智力 | 精神
      check:
        - 随<user>分配属性点、装备、技能、永久性药剂等效果影响而变化
        - 单次变化应有明确的剧情依据
    ${资源值}上限:
      type: number
      资源值: 生命值 | 法力值 | 体力值
      check:
        - 属性变化时检查并更新
        - 根据装备、技能、药剂的效果更新
    ${资源值}:
      type: number
      资源值: 生命值 | 法力值 | 体力值
      check:
        - 随战斗、施法、行动消耗或治疗、休息恢复
        - 不可超过对应上限
    金钱:
      type: number
      check:
        - 随交易、获取、消费更新
        - 四舍五入取整
    背包:
      type: |-
        {
          [物品名称: string]: {
            品质: string;
            类型: string;
            数量: number;
            标签: string[];
            效果: { [效果名: string]: string };
            描述: string;
          }
        }
      check:
        - 随<user>获取、使用、丢弃物品更新
        - 物品数量为0时自动移除
        - 物品名称必须为中文
    装备: &equip
      type: |-
        {
          [装备名称: string]: {
            品质: string;
            类型: string;
            标签: string[];
            效果: { [效果名: string]: string };
            描述: string;
            位置: string;
          }
        }
      check:
        - 随角色穿戴、卸下、损毁、替换装备时更新
        - 同一位置不可装备多件
        - 装备名称必须为中文
    技能: &skill
      type: |-
        {
          [技能名称: string]: {
            品质: string;
            类型: string;
            消耗: string;
            标签: string[];
            效果: { [效果名: string]: string };
            描述: string;
          }
        }
      check:
        - 随角色学习、遗忘、升级技能更新
        - 技能名称必须为中文
    状态效果:
      type: |-
        {
          [效果名称: string]: {
            类型: '增益' | '减益' | '特殊';
            效果: string;
            层数: number;
            剩余时间: string;
            来源: string;
          }
        }
      check:
        - 随<user>获得、消除状态效果更新
        - 剩余时间必须按照'世界.时间'的流逝而减少
        - 进入/脱离战斗，剩余时间必须相应更新为回合数/实际时间
        - 在战斗中时，<user>进行一次完整的行动视为经过1个回合
        - 剩余时间归零或效果触发后移除
        - 层数变化需有明确原因
    登神长阶: &ascension
      是否开启:
        type: boolean
        check:
          - 等级达到12级且经验值满/13级以上时更新为true
          - 变为true后不可再次更改
      要素:
        type: |-
          { [能力名称: string]: { [属性: string]: string } }
        check:
          - 随角色获取要素更新
          - 最多持有3个要素
          - 3要素合成1权能后清空
      权能:
        type: |-
          { [能力名称: string]: { [属性: string]: string } }
        check:
          - 随要素合成或剧情获取更新
          - 最多持有1个权能
          - 拥有权能并通过试炼获得1法则后清空
      法则:
        type: |-
          { [能力名称: string]: { [属性: string]: string } }
        check:
          - 随权能合成或剧情获取更新
          - 获得神位前仅能拥有1个法则
          - 获得神位后可拥有多个法则
      神位:
        check:
          - 随角色成神更新
      神国:
        名称:
          check:
            - 随角色建立、命名神国更新
        描述:
          check:
            - 随神国发展、变化更新

  命定系统:
    命运点数:
      type: number
      value: FP，{{getvar::fp定义}}
      check:
        - 随<user>消耗或获取命运点更新
        - 不可为负数
    命定之人:
      type: |-
        {
          [角色名: string]: {
            是否在场: boolean;
            种族: string;
            身份: string[];
            职业: string[];
            生命层级: string;
            等级: number;
            属性: { 力量: number; 敏捷: number; 体质: number; 智力: number; 精神: number };
            装备: { [装备名: string]: { 品质: string; 类型: string; 标签: string[]; 效果: { [k: string]: string }; 描述: string; 位置: string } };
            技能: { [技能名: string]: { 品质: string; 类型: string; 消耗: string; 标签: string[]; 效果: { [k: string]: string }; 描述: string } };
            登神长阶: { 是否开启: boolean; 要素: object; 权能: object; 法则: object; 神位: string; 神国: { 名称: string; 描述: string } };
            性格: string;
            喜爱: string;
            外貌: string;
            着装: string;
            是否缔结契约: boolean;
            好感度: number;
            心里话: string;
            背景故事: string;
          }
        }
      check:
        - 必须根据<user>的主观意图更新
        - 角色名称必须使用唯一、完整、正式的名称
        - 命定之人未缔结契约且<user>不再留恋时，直接删除
      "${角色名}":
        是否在场:
          type: boolean
          check:
            - 随剧情推进、角色行动更新
        种族: *race
        身份: *identity
        职业: *occupation
        生命层级:
          check:
            - 随角色完成层级突破更新
        等级:
          type: number
          range: 1~25
          check:
            - 随角色战斗、历练、获得机缘等情况变化
        属性.${五维}:
          type: number
          五维: 力量 | 敏捷 | 体质 | 智力 | 精神
          check:
            - 随装备、技能、永久性药剂等效果影响而变化
            - 单次变化应有明确的剧情依据
        装备:
          <<: *equip
          check:
            - 命定之人的装备栏可作为背包使用
            - 随角色穿戴、卸下、损毁、替换物品时更新
            - 同一位置不可装备多件
            - 位置为背包时可重复，表示物品在行囊中，且必须在描述中说明具体数量
            - 装备名称必须为中文
        技能: *skill
        登神长阶: *ascension
        性格:
          check:
            - 仅当角色性格发生显著变化时才更新
        喜爱:
          value: 角色喜爱的人、事物、特长、习惯、爱好等
          check:
            - 随剧情推进、角色实际行为更新
        外貌:
          value: 角色的生理特征、外貌、身高、身材、气质、嗓音等
          check:
            - 仅当角色外貌发生显著变化时才更新
        着装:
          value: 角色当前的服装、饰品、配饰等
          check:
            - 随剧情推进、角色实际行为更新
        是否缔结契约:
          type: boolean
          check:
            - 随<user>的实际行动更新
            - 变为true后不可再次更改
        好感度:
          type: number
          range: -100~100
          check:
            - 变化区间为-5~5
            - 具体变化规则参考'好感度定义'
        心里话:
          value: 角色对<user>的看法与心里话
          check:
            - 随剧情推进更新
            - 每次回复都需要更新
        背景故事:
          value: 角色的动态背景故事
          check:
            - 仅发生对角色经历有重大影响的事件时才更新
            - 通常在原有背景故事基础上补充

  新闻:
    阿斯塔利亚快讯:
      type: |-
        {
          势力要闻: string; // 各大王国、教会、公会等顶尖势力的最新动向
          尊位行迹: string; // 传说或史诗级强者的公开活动记录
          军事行动: string; // 规模性的军队调动、边境冲突或战争情报
          经济动脉: string; // 对大陆经济有重大影响的商路、资源禁运等消息
          灾害预警: string; // 天灾、瘟疫、魔兽潮等广域性灾难的预警
        }
      value: 播报阿斯塔利亚大陆范围内，最重要且具有普遍影响力的官方新闻；内容风格客观、正式
      check: &news_check
        - 新闻内容为空时需立刻进行一次全量更新
        - 不得围绕<user>经历展开，只有<user>做出有重大影响力的事件才会上新闻
        - 每次回复需更新其中2~3条
        - 如有<user>正在追寻的新闻，应视实际情况提前或延后更新
        - 每条新闻内容至少80字
    酒馆留言板:
      type: |-
        {
          高额悬赏: string; // 附近区域赏金异常丰厚的讨伐或搜寻任务
          冒险发现: string; // 冒险者声称发现的未知遗迹、洞穴或资源点
          怪物异动: string; // 附近强大魔物苏醒、迁徙或异常聚集的情况
          通缉要犯: string; // 附近城镇正在通缉的危险罪犯及其特征
          宝物传闻: string; // 附近某地出现稀有装备、物品或财宝的消息
        }
      value: 记录<user>所在区域附近的流言蜚语和冒险者圈内新闻；消息真假难辨，常隐藏任务线索
      check: *news_check
    午后茶会:
      type: |-
        {
          社交逸闻: string; // 贵族名流或英雄人物的风流韵事与人际八卦
          千里远望: string; // 不在场且已缔结契约的命定之人此时的所作所为
          命运涟漪: string; // <user>附近区域，符合<user>喜好且尚未相识的潜力角色
          邂逅预兆: string; // 某角色主动计划与<user>见面的预告；fotmat: ${什么样子的角色在什么地点做了什么事}
        }
      value: 内容聚焦于大陆知名人物的情感八卦与私人动态，{{getvar::爆料风格}}
      check: *news_check
