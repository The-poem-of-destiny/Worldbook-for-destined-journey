---
variables_update_format:
  rule:
    - You MUST output the update analysis and the actual update commands at once in the end of the next reply
    - The update commands works like the **JSON Patch (RFC 6902)** standard, must be a valid JSON array containing operation objects, but supports the following operations instead:
      - replace: replace the value of existing paths
      - delta: update the value of existing number paths by a delta value (the delta value MUST be a number without quotes)
      - insert: insert new items into an object or array
      - remove
    - Don't update field names starts with `_` as they are readonly, such as `_变量`
    - When a typed variable requires an empty state (or is temporarily unassigned), you MUST assign it a concrete empty value. You MUST NOT use null
    - "CRITICAL: You MUST document ALL information from the plot content with COMPLETE detail in variable values. This includes full descriptions, exact quotes, specific attributes, numerical values, and contextual details. Any summarization, abbreviation, or omission of details is STRICTLY FORBIDDEN. When updating variables, preserve EVERY piece of information verbatim"
  format: |-
    <UpdateVariable>
      ${concisely display every `check` in `variables_update_rules` document before actual variable analysis}
      <Analysis>/* IN ENGLISH, no more than 80 words */
      - ${calculate time passed: ...}
      - ${decide whether dramatic updates are allowed as it's in a special case or the time passed is more than usual: yes/no}
      - ${analyze every variable based on its corresponding `check`, according only to current content instead of previous plots: ...}
      </Analysis>
      <JSONPatch>
      [
        { "op": "replace", "path": "${/path/to/variable}", "value": "${new_value}" },
        { "op": "delta", "path": "${/path/to/number/variable}", "value": ${positve_or_negative_delta} },
        { "op": "insert", "path": "${/path/to/object/new_key}", "value": "${new_value}" },
        { "op": "remove", "path": "${/path/to/array/0}" },
        ...
      ]
      </JSONPatch>
    </UpdateVariable>