# AI Agent 工作指南 & 世界书内容索引 (.clinerules)

本文件专为 AI 助手（如 Roo Code, Cline, Cursor, GitHub Copilot 等）设计，以帮助你理解和操作这个 SillyTavern 的《命定之诗》世界书（Worldbook）项目。

在接到用户的任务时，**请首先查阅本指南中对应的章节**，了解你需要修改或读取的文件位置。

---

## 1. 项目架构与运作机制

### 核心概念
- 本项目是为 SillyTavern (ST) 准备的“世界书”内容仓库，主要包含各种背景设定、角色、阵营、机制等。
- `命定之诗.yaml` 是世界书的主索引文件，由 `tavern_sync` 的格式管理。所有在游戏中生效的条目都必须注册在这里。
- 具体的设定文本分散在 `命定之诗/` 各个子目录下。

### 工作流规则 (Agent Workflow Rules)
1. **查阅资料**：当你需要了解“某个种族”、“某个国家”或“某个角色”时，不要要求用户提供详情。请直接查阅项目根目录下 `worldbook_indexes/` 文件夹中对应分类的索引文件（例如 `worldbook_indexes/角色.md`），通过名称找到路径，并使用 `read_file` 工具读取该设定文件。
2. **新增设定**：
   - 首先在 `命定之诗/` 对应的子目录（例如 `角色` 或 `冒险区域`）中新建对应的设定文本文件（`.txt` 或 `.yaml`）。
   - 然后，打开根目录的 `命定之诗.yaml`，参照现有条目添加一个新的记录。
   - **注意**：`命定之诗.yaml` 中引用的 `文件` 字段使用的是相对路径（例如：`命定之诗\角色\某角色`），并且**通常省略文件后缀名**！请遵守此格式规范。
3. **忽略无关目录**：`待审核` 目录的内容暂未生效或处于审核阶段，如果用户没有特别要求，请忽略其中的内容。
4. **修改已有设定**：不要直接去 `命定之诗.yaml` 里面找正文，它只是个索引。你应当去对应的子目录修改真正的 `.txt`, `.yaml`, 或 `.ejs` 文件。

---

## 2. 核心分类目录说明

- **COT**: Chain of Thought 配置（如 `正文cot(专用预设关).yaml` 等），控制输出格式。
- **DLC**: 独立扩展包或客串/联动内容（含有角色、设定等扩展）。
- **变量**: 用于动态追踪剧情或属性状态的 EJS 脚本和规则。
- **世界设定**: 宇宙观、基本法则、地理总览。
- **势力**: 各大国家、联盟、势力的设定。
- **城镇**: 各阵营或区域的城市及下属地点（如 `北罗马\城镇`）。
- **冒险区域**: 高危地带、地下城、荒野（如 `无尽树海`）。
- **产业**: 经济、贸易、工种设定。
- **组织**: 跨区域或独立的公会、教会组织。
- **种族**: 生物分类与种族特性（智慧生物、不定形生物等）。
- **怪物生态**: 魔物习性、灾害。
- **角色**: 具体NPC的设定、外观、称号。
- **额外设定**: 角色生成、好感度、经济价格指南等系统设定。
- **快捷功能**: 特殊的触发指令（如 `【快速任务】`、`【跳过战斗】`）。
- **系统**: 控制系统底层、升级、UI反馈的规则。
- **事件**: 特殊剧情事件触发及其状态流转。

---

## 3. 文件全览指南 (File Index Guide)

由于本项目文件内容过于庞大，包含所有设定文件路径与简短预览的【文件全览】已被拆分并移至独立文件夹。
**当你需要查阅任何“种族”、“势力”、“地区”或“角色”的具体文件路径时：**
请直接使用读取工具查阅项目根目录下 `worldbook_indexes/` 文件夹中对应的分类索引文件（例如 `worldbook_indexes/角色.md`）。
